<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeighNa 交易平台 - 回测详情</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .sidebar-link.active { background-color: #3b82f6; color: white; }
    </style>
    <link rel="preconnect" href="https://rsms.me/">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
</head>
<body class="bg-gray-100">
    <div class="flex h-screen bg-gray-200">
        <!-- Sidebar Placeholder -->
        <div id="sidebar-placeholder"></div>

        <!-- Main content -->
        <div class="flex-1 flex flex-col overflow-hidden ml-64">
            <!-- 头部 -->
            <header class="bg-white shadow p-4 flex justify-between items-center">
                <div class="flex items-center">
                    <a href="models.html" class="text-blue-500 hover:text-blue-700 mr-2">
                        <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                    </a>
                    <h1 class="text-xl font-semibold text-gray-800">回测详情：双均线-IF回测</h1>
                </div>
                <div class="flex space-x-2">
                    <button class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                        导出报告
                    </button>
                    <button class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                        部署到实盘
                    </button>
                </div>
            </header>

            <!-- 内容区域 -->
            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6">
                <div class="container mx-auto space-y-6">

                    <!-- 回测概览 -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4 border-b pb-2">回测概览</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">策略名称</h3>
                                <p class="text-lg font-semibold">双均线-IF回测</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">策略类型</h3>
                                <p class="text-lg font-semibold">DoubleMA</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">交易合约</h3>
                                <p class="text-lg font-semibold">IF2109.CFFEX</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">回测区间</h3>
                                <p class="text-lg font-semibold">2021-01-01 至 2021-06-30</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">起始资金</h3>
                                <p class="text-lg font-semibold">1,000,000 元</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">结束资金</h3>
                                <p class="text-lg font-semibold text-green-600">1,079,000 元</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">总收益率</h3>
                                <p class="text-lg font-semibold text-green-600">+7.9%</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">年化收益率</h3>
                                <p class="text-lg font-semibold text-green-600">+15.8%</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">最大回撤</h3>
                                <p class="text-lg font-semibold text-red-600">-8.5%</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">夏普比率</h3>
                                <p class="text-lg font-semibold">1.85</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">收益回撤比</h3>
                                <p class="text-lg font-semibold">1.86</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">胜率</h3>
                                <p class="text-lg font-semibold">62.5%</p>
                            </div>
                        </div>
                    </div>

                    <!-- 策略参数 -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4 border-b pb-2">策略参数</h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">快速均线周期</h3>
                                <p class="text-lg font-semibold">10</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">慢速均线周期</h3>
                                <p class="text-lg font-semibold">30</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">固定手数</h3>
                                <p class="text-lg font-semibold">1</p>
                            </div>
                            <div>
                                <h3 class="text-sm font-medium text-gray-500">K线周期</h3>
                                <p class="text-lg font-semibold">15分钟</p>
                            </div>
                        </div>
                    </div>

                    <!-- 收益曲线 -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4 border-b pb-2">收益曲线</h2>
                        <div class="h-80">
                            <canvas id="equityCurve"></canvas>
                        </div>
                    </div>

                    <!-- 回撤曲线 -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4 border-b pb-2">回撤曲线</h2>
                        <div class="h-80">
                            <canvas id="drawdownCurve"></canvas>
                        </div>
                    </div>

                    <!-- 交易记录 -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4 border-b pb-2">交易记录</h2>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">成交时间</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">合约</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">方向</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">开平</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">价格</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">数量</th>
                                        <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">交易盈亏</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">2021-01-05 10:15:00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">IF2109.CFFEX</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600">多</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">开仓</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">5,230.00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">1</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">-</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">2021-01-12 14:30:00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">IF2109.CFFEX</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600">多</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">平仓</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">5,280.00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">1</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600">+5,000.00</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">2021-01-15 09:45:00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">IF2109.CFFEX</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-red-600">空</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">开仓</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">5,310.00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">1</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">-</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">2021-01-20 11:30:00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-900">IF2109.CFFEX</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-red-600">空</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">平仓</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">5,250.00</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-500">1</td>
                                        <td class="px-4 py-3 whitespace-nowrap text-sm text-green-600">+6,000.00</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-4 text-right">
                            <a href="#" class="text-blue-500 hover:underline">查看全部交易记录</a>
                        </div>
                    </div>

                    <!-- 每日盈亏 -->
                    <div class="bg-white p-6 rounded-lg shadow">
                        <h2 class="text-lg font-semibold text-gray-700 mb-4 border-b pb-2">每日盈亏</h2>
                        <div class="h-80">
                            <canvas id="dailyPnL"></canvas>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // 收益曲线图表
        const equityCurveCtx = document.getElementById('equityCurve').getContext('2d');
        const equityCurveChart = new Chart(equityCurveCtx, {
            type: 'line',
            data: {
                labels: ['2021-01-01', '2021-01-15', '2021-02-01', '2021-02-15', '2021-03-01', '2021-03-15', '2021-04-01', '2021-04-15', '2021-05-01', '2021-05-15', '2021-06-01', '2021-06-15', '2021-06-30'],
                datasets: [{
                    label: '账户净值',
                    data: [1000000, 1005000, 1015000, 1025000, 1020000, 1030000, 1040000, 1035000, 1045000, 1055000, 1065000, 1070000, 1079000],
                    borderColor: 'rgb(59, 130, 246)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    fill: true,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        });

        // 回撤曲线图表
        const drawdownCurveCtx = document.getElementById('drawdownCurve').getContext('2d');
        const drawdownCurveChart = new Chart(drawdownCurveCtx, {
            type: 'line',
            data: {
                labels: ['2021-01-01', '2021-01-15', '2021-02-01', '2021-02-15', '2021-03-01', '2021-03-15', '2021-04-01', '2021-04-15', '2021-05-01', '2021-05-15', '2021-06-01', '2021-06-15', '2021-06-30'],
                datasets: [{
                    label: '回撤率',
                    data: [0, -0.5, -1.2, -0.8, -2.5, -1.5, -0.5, -3.2, -2.1, -1.5, -0.8, -1.2, -0.5],
                    borderColor: 'rgb(239, 68, 68)',
                    backgroundColor: 'rgba(239, 68, 68, 0.1)',
                    fill: true,
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    }
                },
                scales: {
                    y: {
                        reverse: true
                    }
                }
            }
        });

        // 每日盈亏图表
        const dailyPnLCtx = document.getElementById('dailyPnL').getContext('2d');
        const dailyPnLChart = new Chart(dailyPnLCtx, {
            type: 'bar',
            data: {
                labels: ['2021-01-05', '2021-01-12', '2021-01-15', '2021-01-20', '2021-02-03', '2021-02-10', '2021-02-18', '2021-03-05', '2021-03-15', '2021-04-02', '2021-04-12', '2021-05-06', '2021-05-20', '2021-06-08', '2021-06-25'],
                datasets: [{
                    label: '每日盈亏',
                    data: [2500, 5000, -1500, 6000, 3500, -2000, 4500, 5500, -3000, 2000, -1500, 4000, 3500, 2500, 3000],
                    backgroundColor: function(context) {
                        const value = context.dataset.data[context.dataIndex];
                        return value < 0 ? 'rgba(239, 68, 68, 0.7)' : 'rgba(16, 185, 129, 0.7)';
                    }
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>

    <!-- Load Sidebar Script -->
    <script src="../js/load_sidebar.js"></script>
</body>
</html>
